# ===============================================
# Core PyTorch (CUDA 12.8, Ampere Optimized)
# ===============================================
torch==2.8.0+cu128 --index-url https://download.pytorch.org/whl/cu128
torchvision==0.23.0+cu128 --index-url https://download.pytorch.org/whl/cu128
torchaudio==2.8.0+cu128 --index-url https://download.pytorch.org/whl/cu128

# ===============================================
# Ampere-Specific Optimizations
# ===============================================
# Flash Attention 2 (2-3x faster on Ampere)
# Pre-built wheel for CUDA 12.8 and Python 3.11
flash_attn==2.8.3+cu12torch2.8cxx11abiFALSE --extra-index-url https://github.com/Dao-AILab/flash-attention/releases/download/v2.8.3/

# torchao (INT8 quantization, ~40% VRAM reduction)
torchao==0.13.0

# ===============================================
# VibeVoice Core Dependencies
# ===============================================
accelerate==1.6.0
transformers==4.51.3
diffusers>=0.36.0
huggingface-hub>=0.36.0
safetensors>=0.7.0
tokenizers>=0.21.0

# ===============================================
# Audio Processing
# ===============================================
librosa==0.11.0
soundfile>=0.12.1
pydub>=0.25.1
av>=16.1.0

# ===============================================
# Scientific Computing
# ===============================================
numpy>=2.3.0
scipy>=1.17.0
numba>=0.57.0
llvmlite>=0.40.0

# ===============================================
# API Framework
# ===============================================
fastapi>=0.128.5
uvicorn[standard]>=0.40.0
python-multipart>=0.0.22
pydantic>=2.12.0
pydantic-settings>=2.12.0
python-dotenv>=1.0.0
sse-starlette>=3.2.0
httpx>=0.26.0
aiofiles>=24.1.0

# ===============================================
# Utilities
# ===============================================
tqdm>=4.67.0
ml-collections>=1.1.0
absl-py>=2.4.0
gradio>=6.5.1
aiortc>=1.14.0
einops>=0.8.0

# ===============================================
# Additional Dependencies (installed via PyTorch wheel)
# ===============================================
# These are automatically installed with PyTorch 2.8.0+cu128
# nvidia-cuda-runtime-cu12==12.8.90
# nvidia-cuda-cupti-cu12==12.8.90
# nvidia-cudnn-cu12==9.10.2.21
# nvidia-cublas-cu12==12.8.4.1
# nvidia-cufft-cu12==11.3.3.83
# nvidia-curand-cu12==10.3.9.90
# nvidia-cusolver-cu12==11.7.3.90
# nvidia-cusparse-cu12==12.5.8.93
# nvidia-cusparselt-cu12==0.7.1
# nvidia-nccl-cu12==2.27.3
# nvidia-nvjitlink-cu12==12.8.93
# nvidia-cufile-cu12==1.13.1.3
# triton==3.4.0
